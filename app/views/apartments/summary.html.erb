<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Apartment Configuration Summary</title>
  <style>
    body { font-family: Arial, sans-serif; color: #333; padding: 2rem; }
    h1, h2 { text-align: center; }
    ul { list-style: none; padding: 0; }
    li { padding: 0.5rem 0; border-bottom: 1px solid #eee; }
    .total { font-weight: bold; margin-top: 1rem; font-size: 1.2rem; }
    .section { margin-bottom: 2rem; }
  </style>
</head>
<body>
  <h1>Apartment Configuration Summary</h1>
  <h2>
    Floor <%= apartment.floor %> –
    <%= apartment.size %> m²,
    <%= apartment.rooms %> rooms
  </h2>

  <% if apartment.image.attached? %>
    <div style="text-align:center; margin:1rem 0;">
      <%= image_tag apartment.image, style: "max-width:400px; width:100%; height:auto;" %>
    </div>
  <% end %>

  <% data = config.data || {} %>

  <div class="section">
    <p>
      <strong>Base Price:</strong>
      €<%= number_with_delimiter(data["base_price"] || apartment.price) %>
    </p>

    <ul>

      <% if data.dig("style", "value").present? %>
        <li>
          <strong>Style:</strong>
          <%= data.dig("style", "value") %>
        </li>
      <% end %>

      <% if data["wall_color"].present? %>
        <li>
          Wall Color:
          <%= data.dig("wall_color", "value") %>
          (€<%= number_with_delimiter(data.dig("wall_color", "totalPrice")) %>)
        </li>
      <% end %>

      <% if data["floor_texture"].present? %>
        <li>
          Floor Texture:
          <%= data.dig("floor_texture", "value") %>
          (€<%= number_with_delimiter(data.dig("floor_texture", "totalPrice")) %>)
        </li>
      <% end %>

      <% if data["lighting"].present? %>
        <li>
          Lighting:
          <%= data.dig("lighting", "value") %>
          (€<%= number_with_delimiter(data.dig("lighting", "price")) %>)
        </li>
      <% end %>

      <% if data["additional_options"].present? %>
        <% data["additional_options"].each do |opt| %>
          <li>
            <%= opt["value"] %>
            (€<%= number_with_delimiter(opt["price"]) %>)
          </li>
        <% end %>
      <% end %>

    </ul>

    <p class="total">
      Total Price:
      €<%= number_with_delimiter(total_price) %>
    </p>
  </div>

  <% if apartment.description.present? %>
    <div class="section">
      <p><strong>Description:</strong> <%= apartment.description %></p>
    </div>
  <% end %>
</body>
</html>
